
unit_cert = '''\
-----BEGIN CERTIFICATE-----
MIICbzCCAVegAwIBAgIIdGLO/n3tWkswDQYJKoZIhvcNAQELBQAwFjEUMBIGA1UE
AwwLQmF0Y2ggIzIgQ0EwHhcNMTcxMjAxMDAwMDAwWhcNMzcwMTAxMDAwMDAwWjBF
MTAwLgYDVQQFEydQRVhFVkVLTEdSSUZDSUNLSklZQkNIUUM3NCtjZDIyOWZiZDg0
MDUxETAPBgNVBAMMCE9wZW5kaW1lMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE
QYDmBQjRfz0GIx+/XxlCmWSbBUAdoLocyhGFsbEmVdjoeSBhUfdQxTnZqDL+sAhZ
VpQ7u94PktXWqtkixjIvPqNdMFswHwYDVR0jBBgwFoAUpFMtojUkAxZOt1KjqKoq
tQzRZX0wCQYDVR0TBAIwADAdBgNVHQ4EFgQUDq/ptUVsRj3kxk/Bm4Wi3xuPCrgw
DgYDVR0PAQH/BAQDAgeAMA0GCSqGSIb3DQEBCwUAA4IBAQBJ57KBQng/XeriNox7
UqF1Y4U6SrGW0Fcgq1yuNZvTFyKmOw5NxiyqvKz8RDDC7jgX9Mkrt1AVNeH4jdhn
6vSgPcIwLf7l+lqSlTo1TL5hyZZVyMuiu9Rzr1F1ZwoVzUSV/kiEsFC0JhT/TEBC
LaD8ja4Plfi9oy84ymyUX9UpWNDSNsvJOegqhI96lMwHEi3lQ3s67qKez/2qKGEO
p+b364TZmwC507oJS5X06apMRc54bp6rbqiYsL/QajB36vHHbAvd9FzsBxMD16KA
h2jf0q3w7Xi2AzLLepV0Hf97D5EUybyZhUdOkEq3tl2WDLZpN/t8A8zDz+aB0dAL
JjB8
-----END CERTIFICATE-----
'''

chain_cert = '''\
-----BEGIN CERTIFICATE-----
MIIDrTCCApWgAwIBAgIBATANBgkqhkiG9w0BAQsFADB4MQswCQYDVQQGEwJDQTEQ
MA4GA1UECAwHT250YXJpbzEQMA4GA1UEBwwHVG9yb250bzEWMBQGA1UECgwNQ29p
bmtpdGUgSW5jLjERMA8GA1UECwwIT3BlbmRpbWUxGjAYBgNVBAMMEUZhY3Rvcnkg
Um9vdCBDQSAxMB4XDTE3MDIwMTAwMDAwMFoXDTM3MDEwMTAwMDAwMFoweDELMAkG
A1UEBhMCQ0ExEDAOBgNVBAgMB09udGFyaW8xEDAOBgNVBAcMB1Rvcm9udG8xFjAU
BgNVBAoMDUNvaW5raXRlIEluYy4xETAPBgNVBAsMCE9wZW5kaW1lMRowGAYDVQQD
DBFGYWN0b3J5IFJvb3QgQ0EgMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
ggEBAMKw2OjepDwxyqQGZkh519+snMHzI1eR6vrOInaKDmq2sTQE5x5PMoNdWEp6
f0V1L5e5YAfVfazu5L/d2GQDI2JIsCQGP7vYkqkGfFRAvzWPMiNrwNkPQymPFC5P
+2rRxAk+W9mTpjA0oZ6Xp5+B5oWTulGYygPleO6WxxKvxGEcD0WOZQqDmIRVIcCD
1DiEHqDWmHzRO6yUaHrM323iR/8RrkVSn288vcOUOHe3cG9LSWaMwBB+BtcyKGJf
i8fudSQdSQS75HkznFIs2E6f2tja42LmL+E37FftcbaAL8yvk5hqA8PWvkZ/1Foj
SJehAuMa/sHqRE1jdJeG4jCC3c8CAwEAAaNCMEAwDwYDVR0TAQH/BAUwAwEB/zAd
BgNVHQ4EFgQUNEwRZVIzdnrWOFPw1B+vTWZAYOgwDgYDVR0PAQH/BAQDAgEGMA0G
CSqGSIb3DQEBCwUAA4IBAQC0h+a23N0gTQKMY7wCTGPsnupOkdA9fdL8jSoJF1sH
BoDtnftkw97FK+NJ7Wvl0gg1O9wiHyU+j2fP4M6k5iF+R8cg35jFNekMNizbR+Ey
8Lnp8kR9fn1tNzZS2UlaEX6k9EGWFvEq4PL4rSvbz7RSSCogQ4x7/5vGFjKYVluA
CVp1F4nYuzlB87ewBH9qU821y/3YcdbBdqb+U/EK1/JU1k29RitgNjg0AFu2Yj1f
oiGlcjWgMxJmTrlboJlal+adQY6G1f7vaD84hnHsRPnlJAkNQr5XannzTrxwZZQu
0oAwidheaTMUEiGDMRGCPhYvmP8DsasZwifPE5FNBi50
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDbTCCAlWgAwIBAgICA+owDQYJKoZIhvcNAQELBQAweDELMAkGA1UEBhMCQ0Ex
EDAOBgNVBAgMB09udGFyaW8xEDAOBgNVBAcMB1Rvcm9udG8xFjAUBgNVBAoMDUNv
aW5raXRlIEluYy4xETAPBgNVBAsMCE9wZW5kaW1lMRowGAYDVQQDDBFGYWN0b3J5
IFJvb3QgQ0EgMTAeFw0xNzA3MDEwMDAwMDBaFw0zNzAxMDEwMDAwMDBaMBYxFDAS
BgNVBAMMC0JhdGNoICMyIENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC
AQEAsXtcpBvFU+uuaRo58lXOVkTT0Wqz89+6dWk7htc601PnCp5hSxi8xzifTuiQ
whCX8ISx5FyxfpDs7sXYL6BqU4I0lqFPvWU/qXJtwPyXKQqqGzwmNJiV4rTxIaCN
5xTpqegRO15EeEZx2ljeM5h6/p2soQgur2k/yxNh9/GYRoZgVBmFgKtoB9IAfS53
F6outWzXu8SDawM84EqdHVroe1YiraQoG6hiKTL8gvRgO9uHcTyp6WgQ/Gh4eauF
IK3D8bK1RpwWPrRyGZdYPA8CHGH0x6gLgsgCRNgSh44joMUfx9DQd+G16EZgrD4V
EGANdPsXaZQe2I8yTAGwWggWMQIDAQABo2MwYTAfBgNVHSMEGDAWgBQ0TBFlUjN2
etY4U/DUH69NZkBg6DAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBSkUy2iNSQD
Fk63UqOoqiq1DNFlfTAOBgNVHQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQELBQADggEB
AMD0oionmQ7xVVYdyWAx/peDc3NKkrHLhzSIhy7MYou8Q07PnougLdIwcahel8r0
Ztn4Ayn5XViq9rfkdW9HHLOE/IFKhZgQ3sF236tUXlB/fEtdSJCai0cPtYwAIp8U
H2/W79lOi7zK06ppuVyWxaNqWI9BcKzIBMOuyibqAHPHJU8EyMwHldbod0+WbBl9
Siio/4fKZZxKMkNcIC1tKydFJXbfbIybl0NDBqkL8OsVW8E6rOSdqSmpgjZhkQmW
Q18RdFR13uFSRRiCQS0Yuix9kjTAbxHwii4baLNw32VHE6KPH+JZTenXpy/1XIGb
bhb/2wol/McYrMp4IYoUxJo=
-----END CERTIFICATE-----
'''


import ngu
c = ngu.cert.x509()
c.parse(unit_cert)
#print(repr(c))
assert 'Opendime' in repr(c)
assert 'serialNumber=PEXEVEKLGRIFCICKJIYBCHQC74+cd229fbd8405' in repr(c)
pubkey = c.get_ec_pubkey()
assert pubkey[0] == 4 and len(pubkey) == 65

c2 = ngu.cert.x509()
c2.parse(chain_cert)
#print(repr(c2))
assert 'Coinkite Inc.' in repr(c2)
try:
    print(c2.get_ec_pubkey())
except TypeError:
    pass

em = ngu.cert.x509()
try:
    print(em.get_ec_pubkey())
except ValueError:
    pass


print('PASS - test_cert')
